//2019-06-25 Try handling stylesheet errors (webfont of css)
//2019-10-30 excel_upload address fix
//2019-12-08 excel_upload ,download javascript로 변환
//2019-12-15 excel_upload시 0101은 문자로 1010은숫자로 인식 되는 현상 수정
//2020-10-27 그리드 font명에 공백이 있을경우 엑셀 출력시 오류 수정
//2020-12-09 getWaiElem 수정 - innerHtml 속성 확인
//2021-02-10 Excel 출력 cell width가 없을 경우 기본 width=100 지정
//2021-02-25 FileUpload 경로에서 / 제거
//2021-04-18 엑셀 업로드 수정
//2021-05-07 엑셀 업로드 RichText 처리 추가
//2021-12-15 엑셀 모듈 Dynamic loading
//2022-01-26 스크롤 drag중에는 doMouseEventProc시 true 리턴
//2022-02-18 Anchor 기능 추가
//2022-03-24 Data Control 추가
//2022-04-07 Scroll mouse event 수정
//2022-05-25 FileDownload가 0byte 일경우 수정
//2022-07-19 FileDownload 오류시 Progressbar 삭제
//2022-07-21 _multiLangManager 추가
//2022-09-26 _metaCodeManager 추가
//2022-12-22 css 변수 기능 추가
//2023-01-02 css 변수 font 추가
//2023-01-03 css variable 감지 추가
//2023-03-16 getCssRules 수정 (Bootstrap 사용 조건)

//2019-06-25 Try handling stylesheet errors (webfont of css)
//2019-10-30 excel_upload address fix
//2019-12-08 excel_upload ,download javascript로 변환
//2019-12-15 excel_upload시 0101은 문자로 1010은숫자로 인식 되는 현상 수정
//2020-10-27 그리드 font명에 공백이 있을경우 엑셀 출력시 오류 수정
//2020-12-09 getWaiElem 수정 - innerHtml 속성 확인
//2021-02-10 Excel 출력 cell width가 없을 경우 기본 width=100 지정
//2021-02-25 FileUpload 경로에서 / 제거
//2021-04-18 엑셀 업로드 수정
//2021-05-07 엑셀 업로드 RichText 처리 추가
//2021-12-15 엑셀 모듈 Dynamic loading
//2022-01-26 스크롤 drag중에는 doMouseEventProc시 true 리턴
//2022-02-18 Anchor 기능 추가
//2022-03-24 Data Control 추가
//2022-04-07 Scroll mouse event 수정
//2022-05-25 FileDownload가 0byte 일경우 수정
//2022-07-19 FileDownload 오류시 Progressbar 삭제
//2022-07-21 _multiLangManager 추가
//2022-09-26 _metaCodeManager 추가
//2022-12-22 css 변수 기능 추가
//2023-01-02 css 변수 font 추가
//2023-01-03 css variable 감지 추가
//2023-03-16 getCssRules 수정 (Bootstrap 사용 조건)

var $waiRTL=null;!function(){$waiRTL=new function(){this.getWaiElem=function(t){var e={isComp:!1,objID:void 0,parent:void 0,element:void 0,wrapDiv:void 0};try{for(var i=t.parentElement;;){var o=i.getAttribute("_container");if(void 0===i)break;if("HTML"==i.tagName.toUpperCase()||"BODY"==i.tagName.toUpperCase()||"yes"==o||"Y"==$(i).attr("_innerHtml")){e.isComp=!1,e.compObj=t;break}if("$comp$"==i.getAttribute("iswai")){if(e.isComp=!0,e.objID=i.getAttribute("objid"),e.parent=i.parentElement,e.wrapDiv=i,i.children.length>0)for(var n=0;n<i.children.length;n++){var a=i.children[n];if("NONE"!=(a.style.display+"").toUpperCase()){e.element=a;break}}else e.element=void 0;break}i=i.parentElement}e.isComp||(e.objID=t.getAttribute("id"),e.parent=t.parentElement,e.element=t)}catch(t){}return e},this.getWaiChilds=function(t){for(var e={children:[]},i=0;i<t.children.length;i++){var o=t.children[i];if("$comp$"==o.getAttribute("iswai"))if(o.children.length>0){for(var n=void 0,a=0;a<o.children.length;a++)if("NONE"!=(o.children[a].style.display+"").toUpperCase()){n=o.children[a];break}e.children.push(n)}else e.children.push(o);else e.children.push(t.children[i])}return e},this.getElementByTagName=function(t){var e=$("*"),i=[],o=window;for(var n in e){var a=$waiRTL.getWaiElem(e[n]);if(a.isComp)try{(o[a.objID].declare.tagName+"").toUpperCase()==t.toUpperCase()&&-1==$.inArray(o[a.objID],i)&&i.push(o[a.objID])}catch(t){}else(e[n].tagName+"").toUpperCase()==t.toUpperCase()&&i.push(e[n])}return i},this.checkKeyArr=function(t,e){return e.indexOf(t)>=0}};$wai.classes.compStyleInst=function(t){this._parent=t};$wai.rtl.style=new function(){!function(t){function e(t,e){return/^@/.test(t)?(t=t.split(" "))&&{identifier:t.shift().substr(1).toLowerCase(),parameters:t.join(" ")}:(e?/:$/:/:/).test(t)?(t=t.split(":"))&&{property:t.shift(),value:t.join(":")}:t}t.parseCSS=function(t){return function(t,i,o){for(var n;null!=(n=i.exec(t));)"{"==n[2]?o.block.push(o={selector:e(n[1],!0),block:[],parent:o}):"}"==n[2]?o=o.parent:";"==n[2]&&o.block.push(e(n[1]))}(function(t){return t.replace(/\/\*[\W\w]*?\*\//g,"").replace(/^\s+|\s+$/g,"").replace(/\s*([:;{}])\s*/g,"$1").replace(/\};+/g,"}").replace(/([^:;{}])}/g,"$1;}")}(t),/([^{};]*)([;{}])/g,t={block:[]}),t}}(this),this.getCssRules=function(t,e){var i=document,o=null,n=[],a=!1,r=e??!1;void 0===t?o=document.head.childNodes:(i=t,o=t.head.childNodes);for(var s=["wai.library.bootstrap.start","wai.library.autoLoad.start","wai.library.load.start","wai.dataio.load.start"],l=["wai.library.bootstrap.end","wai.library.autoLoad.end","wai.library.load.end","wai.dataio.load.end"],h=0;h<o.length;h++){var c=o[h];if("#comment"==c.nodeName){var d=(c.nodeValue+"").trim();if("wai.load.start"==d||"wai.loader.start"==d){a=!0;continue}if("wai.load.end"==d||"wai.loader.end"==d)a=!1;else if(s.includes(d))a=!1;else if(l.includes(d)){a=!0;continue}}a||"LINK"==(c.nodeName+"").toUpperCase()&&n.push(c.href)}var u=[],f=[];function p(t){var e=t;return e=(e=(e=e.replace(/\{/," {\n  ")).replace(/\;/g,";\n  ")).replace(/  \}/g,"}")}for(var g=0;g<i.styleSheets.length;g++){var v=i.styleSheets[g],b=`${$wai.info.path}/lib/bootstrap.min.css`,m=u;v.href?.includes(b)&&(m=f);try{for(var w=0;w<v.cssRules.length;w++){var y=v.cssRules[w],C=(y.selectorText+"").trim();if(!(C.indexOf(":")>=0||C.indexOf(">")>=0))for(var O=E(y.selectorText),x=0;x<O.length;x++)if(null==y.parentStyleSheet.href){var S=p(y.cssText);m.push({name:O[x],rule:y,text:S})}else for(var $=0;$<n.length;$++)if(y.parentStyleSheet.href==n[$]){S=p(y.cssText);m.push({name:O[x],rule:y,text:S});break}function E(t){for(var e=(t+"").replace(/,/g,"").trim(),i=[],o="",n=0;n<e.length;n++)"."!=e[n]&&"#"!=e[n]&&" "!=e[n]||(""!==o&&i.push(o),o="")," "!==e[n]&&(o+=e[n]);return""!==o&&i.push(o),i}}}catch(T){}}return r&&(m={basicResult:u,bootstrapResult:f}),m};var t="",e=[];this.getCssRule=function(i,o){var n=null;if(void 0===o)n=this.getCssRuleAsDoc(i);else{!function(i){var o,n,a;if(void 0!==i&&""!==i&&i!=t)for(t=i,e=[],n=0;n<document.styleSheets.length;n++){o=document.styleSheets[n];try{for(a=0;a<o.cssRules.length;a++)(o.cssRules[a].selectorText+"").indexOf(i)>=0&&e.push(o.cssRules[a])}catch(t){console.log(document.styleSheets[n].href,t.message)}}}(o);for(var a=0;a<e.length;a++){curRI=e[a];try{for(var r=curRI.selectorText.split(","),s=0;s<r.length;s++)if(r[s].trim()==i.trim()){n={name:r[s],rule:curRI};break}}catch(t){}}}return n},this.getCssRuleAsDoc=function(t){for(var e=null,i=0;i<document.styleSheets.length;i++)for(var o=document.styleSheets[i],n=null,a=0;a<o.cssRules.length;a++){n=o.cssRules[a];try{for(var r=n.selectorText.split(","),s=0;s<r.length;s++)if(r[s].trim()==t.trim()){e={name:r[s],rule:n};break}}catch(t){}}return e},this.getRule=function(t,e){var i=null,o=this.getCssRule(t,e);if(null!=o){var n=o.rule.cssText,a=this.parseCSS(n);i={name:o.name,cssText:o.rule.cssText,items:{}};try{for(var r=0;r<a.block[0].block.length;r++){var s=a.block[0].block[r];i.items[s.property]=s.value}}catch(t){console.error("_styleManager.getRule cssText parsed error : "+t.message)}}return i},this.getFontInfo=function(t){var e={weight:"",size:12,family:"Tahoma",color:"black",text:""};if(t.font){t.font=t.font.trim();var i=t.font.split("/");if(i.length>0)if((a=(n=i[0]).lastIndexOf("px"))>=1)try{e.size=parseInt(n.substring(0,a).trim())}catch(t){}if(i.length>1){var o=i[1].split(" ");e.weight=o[0],e.family=o[1]}if((a=(n=(e=function(t){var e=null,i=null,o="normal",n="normal",a="normal",r="normal",s=t.split(/\s+/);t:for(;element=s.shift();)switch(element){case"normal":break;case"italic":case"oblique":o=element;break;case"small-caps":a=element;break;case"bold":case"bolder":case"lighter":case"100":case"200":case"300":case"400":case"500":case"600":case"700":case"800":case"900":n=element;break;default:if(!i){var l=element.split("/");i=l[0],l.length>1&&(r=l[1]);break}e=element,s.length&&(e+=" "+s.join(" "));break t}return{style:o,variant:a,weight:n,size:i,lineHeight:r,family:e}}(t.font)).size).lastIndexOf("px"))>=1)try{e.size=parseInt(n.substring(0,a).trim())}catch(t){}}else{var n,a;if(void 0!==t["font-weight"]&&(e.weight=t["font-weight"]),void 0!==t["font-size"])if((a=(n=t["font-size"]).lastIndexOf("px"))>=1)try{e.size=parseInt(n.substring(0,a).trim())}catch(t){console.log("result.size ["+n.substring(0,a)+"]")}void 0!==t["font-family"]&&(e.family=t["font-family"])}return void 0!==t.color&&(e.color=t.color),e.text=e.weight+" "+e.size+"px "+e.family,e},this.getRuleFontInfo=function(t,e){var i=this.getRule(t,e);if(null!=i){if(null!=i.items.color&&-1!=i.items.color.replace(/\s/gi,"").indexOf("var(")){var o=i.items.color.replace(/var\(/gi,"").replace(/\)/gi,"");i.items.color=this.compStyles.getPropertyValue(o)}if(null!=i.items.font&&-1!=i.items.font.replace(/\s/gi,"").indexOf("var(")){o=i.items.font.replace(/var\(/gi,"").replace(/\)/gi,"");i.items.font=this.compStyles.getPropertyValue(o)}n=this.getFontInfo(i.items)}else{var n={weight:"",size:12,family:"Tahoma",color:"black",text:"12px Tahoma"};console.warn("waiGrid fontStyle ["+t+"] not founded. return default",n)}return n},this.getTextFontInfo=function(t){for(var e=["weight","size","family","color"],i={weight:"",size:12,family:"Tahoma",color:"black",text:"12px Tahoma"},o=t.split(" "),n=0,a=0;a<o.length;a++){var r=o[a].trim();if(""!=r){if(1===n){var s=r.substring(0,r.lastIndexOf("px")).trim();i[e[n]]=parseInt(s)}else i[e[n]]=r;n++}}return i.text=i.weight+" "+i.size+"px "+i.family,i};var i=document.getElementsByTagName("head")[0];this.compStyles=getComputedStyle(i);new MutationObserver((function(t){t.forEach((function(t){if("style"==t.attributeName){var e=function(t){var e={},i=t.replace(/\/\*(.|\s)*?\*\//g," ").replace(/\s+/g," ").split(";").map((function(t){return t.split(":").map((function(t){return t&&t.trim()}))}));for(var o in i)e[i[o][0]]=i[o][1];return{cssText:t,style:e}}(t.target.getAttribute("style"));for(var i in e.style)if(0==i.indexOf("--"))for(var o=$(document.body).find('[iswai="$comp$"]'),n=0;n<o.length;n++)window[o[n].id].propChange("CSSVariables","","")}}))})).observe(document.documentElement,{attributes:!0,attributeFilter:["style"]}),this.getRuleItemValue=function(t,e,i){var o=void 0,n=this.getRule(t,i);if(null!=n)if(-1!=n.items[e].replace(/\s/gi,"").indexOf("var(")){var a=n.items[e].replace(/var\(/gi,"").replace(/\)/gi,"");o=this.compStyles.getPropertyValue(a)}else o=n.items[e];return o};this.genCssObject=function(t,e,i){for(var o in t)for(var n in t[o]){var a=t[o][n];if("font"==n){var r=this.getRuleFontInfo(a,i);t[o][n]=r}else if("color"==n)if(typeof a==typeof[])for(var s=0;s<a.length;s++)a[s]=this.getRuleItemValue(a[s],n,i);else t[o][n]=this.getRuleItemValue(a,n,i);else if("content"==n){var l=this.getRuleItemValue(a,n,i);t[o][n]=new Image,t[o][n].src=e.path+"/"+l.replace(/^url\(['"](.+)['"]\)/,"$1")}else try{t[o][n]=this.getRuleItemValue(a,n,i),void 0===t[o][n]&&console.warn("cannot generate cssObject ["+a+"."+n+"]")}catch(t){console.warn("cannot generate cssObject ["+a+"."+n+"]")}}return t,t},this.setFillStyle=function(t,e,i){var o="white";if(typeof e==typeof[])switch(e.length>=2&&(o=t.createLinearGradient(0,i.top,0,i.bottom)),e.length){case 1:o=e[0];break;case 2:o.addColorStop(0,e[0]),o.addColorStop(1,e[1]);break;case 3:o.addColorStop(0,e[0]),o.addColorStop(.5,e[1]),o.addColorStop(1,e[2]);break;case 4:o.addColorStop(0,e[0]),o.addColorStop(.5,e[1]),o.addColorStop(.75,e[2]),o.addColorStop(1,e[3]);break;case 5:o.addColorStop(0,e[0]),o.addColorStop(.25,e[1]),o.addColorStop(.5,e[2]),o.addColorStop(.75,e[3]),o.addColorStop(1,e[4])}else o=e;t.fillStyle=o},this.setFontStyle=function(t,e){t.font=e.text,t.fillStyle=e.color}};$wai.rtl.draw=new function(){this.roundRect=function(t,e,i,o,n,a,r,s){if(void 0===s&&(s=!0),void 0===a&&(a=7),"number"==typeof a)a={tl:a,tr:a,br:a,bl:a};else{var l={tl:0,tr:0,br:0,bl:0};for(var h in l)a[h]=a[h]||l[h]}t.beginPath(),t.moveTo(e+a.tl,i),t.lineTo(e+o-a.tr,i),t.quadraticCurveTo(e+o,i,e+o,i+a.tr),t.lineTo(e+o,i+n-a.br),t.quadraticCurveTo(e+o,i+n,e+o-a.br,i+n),t.lineTo(e+a.bl,i+n),t.quadraticCurveTo(e,i+n,e,i+n-a.bl),t.lineTo(e,i+a.tl),t.quadraticCurveTo(e,i,e+a.tl,i),t.closePath(),r&&t.fill(),s&&t.stroke()}};$wai.classes.iconLoader=function(t,e){var i=this;this.image=new Image,this.loaded=!1,this.image.onload=function(){i.loaded=!0,void 0!==e&&e(i)},this.image.src=t,this.getIconCanvas=function(t,e,i,o){var n=this.image.width,a=this.image.height,r=null;o<n/t&&i<a/e&&((r=document.createElement("canvas")).width=t,r.height=e,r.getContext("2d").drawImage(this.image,t*o,e*i,t,e,0,0,t,e));return r},this.drawIcon=function(t,e,i,o,n,a,r){var s=this.image.width,l=this.image.height;o<s/t&&i<l/e&&n.drawImage(this.image,t*o,e*i,t,e,a,r,t,e)}};$wai.classes.imageLoader=function(t,e){var i=this;this.images=[],this.loaded=!1;for(var o=0,n=0;n<t.length;n++){var a=new Image;a.onload=function(){++o==t.length&&(i.loaded=!0,void 0!==e&&e(i))},a.src=t[n].url;var r={id:t[n].id,image:a,url:t[n].url};this.images.push(r)}this.getImage=function(t){for(var e=null,i=0;i<this.images.length;i++)if(this.images[i].id==t){e=this.images[i];break}return e},this.draw=function(t,e,i,o){var n=this.getImage(t);null!=n&&e.drawImage(n.image,i,o)}};$wai.rtl.sortBy=function(t,e,i){var o=i?function(e){return i(e[t])}:function(e){return e[t]};return e=e?-1:1,function(t,i){return t=o(t),i=o(i),e*((t>i)-(i>t))}};$wai.rtl.sortFieldData=new function(){var t=Object.prototype.toString,e=function(t){return t},i=function(e){return this.parser("[object Object]"===t.call(e)&&e[this.prop]||e)};return function(o,n){return o instanceof Array&&o.length?("[object Object]"!==t.call(n)&&(n={}),"function"!=typeof n.parser&&(n.parser=e),n.desc=[1,-1][+!!n.desc],o.sort((function(t,e){return(((t=i.call(n,t))>(e=i.call(n,e)))-(e>t))*n.desc}))):[]}};$wai.rtl.getDataServicesInfo=function(){for(var t=[],e=$("dataService"),i=0;i<e.length;i++){var o={},n={};for(var a in $(e[i].attributes).each((function(){var t=this.nodeName,e=null;try{e=$wai.info.browser.isFirefox?this.value:this.nodeValue}catch(t){}o[t]=e})),o)n[a]=o[a];t.push(n)}return t};$wai.rtl.setDataServicesInfo=function(t){var e=$("dataServices");e.length>0&&e.remove(),$("body").prepend($.parseXML("<dataServices></dataServices>").documentElement),e=$("dataServices");for(var i=0;i<t.length;i++){var o,n="";for(var a in t[i])typeof t[i][a]==typeof{}||(n+=a+'="'+t[i][a]+'" ');o="<dataService "+n.trim()+"></dataService>",e.append($.parseXML(o).documentElement)}};$wai.rtl.getDataFieldsInfo=function(){for(var t=[],e=$("datafield"),i=0;i<e.length;i++){var o={},n={};for(var a in $(e[i].attributes).each((function(){var t=this.nodeName,e=null;try{e=$wai.info.browser.isFirefox?this.value:this.nodeValue}catch(t){}o[t]=e})),o)n[a]=o[a];t.push(n)}return t};$wai.rtl.setDataFieldsInfo=function(t){var e=$("datafields");e.length>0&&e.remove(),$("body").prepend($.parseXML("<datafields></datafields>").documentElement),e=$("datafields");for(var i=0;i<t.length;i++){var o,n="";for(var a in t[i])typeof t[i][a]==typeof{}||(n+=a+'="'+t[i][a]+'" ');o="<datafield "+n.trim()+"></datafield>",e.append($.parseXML(o).documentElement)}};$wai.rtl.addDataFieldsInfo=function(t){var e=$("datafields");0==e.length&&($("body").prepend($.parseXML("<datafields></datafields>").documentElement),e=$("datafields"));for(var i=0;i<t.length;i++){var o,n="";for(var a in t[i])typeof t[i][a]==typeof{}||(n+=a+'="'+t[i][a]+'" ');o="<datafield "+n.trim()+"></datafield>",e.append($.parseXML(o).documentElement)}};$wai.rtl.getDataGroupsInfo=function(){for(var t=[],e=$("datagroup"),i=0;i<e.length;i++){var o={},n={};for(var a in $(e[i].attributes).each((function(){var t=this.nodeName,e=null;try{e=$wai.info.browser.isFirefox?this.value:this.nodeValue}catch(t){}o[t]=e})),o)n[a]=o[a];t.push(n)}return t};$wai.rtl.setDataGroupsInfo=function(t){var e=$("datagroups");e.length>0&&e.remove(),$("body").prepend($.parseXML("<datagroups></datagroups>").documentElement),e=$("datagroups");for(var i=0;i<t.length;i++){var o,n="";for(var a in t[i])typeof t[i][a]==typeof{}||(n+=a+'="'+t[i][a]+'" ');o="<datagroup "+n.trim()+"></datagroup>",e.append($.parseXML(o).documentElement)}};$wai.rtl.getServiceInfo=function(){for(var t=[],e=$("serviceinfo"),i=0;i<e.length;i++){var o={},n={};for(var a in $(e[i].attributes).each((function(){var t=this.nodeName,e=null;try{e=$wai.info.browser.isFirefox?this.value:this.nodeValue}catch(t){}o[t]=e})),o)n[a]=o[a];t.push(n)}return t};$wai.rtl.setServiceInfo=function(t){var e=$("serviceinfos");e.length>0&&e.remove(),$("body").prepend($.parseXML("<serviceinfos></serviceinfos>").documentElement),e=$("serviceinfos");for(var i=0;i<t.length;i++){var o,n="";for(var a in t[i])typeof t[i][a]==typeof{}||("options"==a&&(t[i][a]=t[i][a].replaceAll(/"/gi,"'")),n+=a+'="'+t[i][a]+'" ');o="<serviceinfo "+n.trim()+"></serviceinfo>",e.append($.parseXML(o).documentElement)}};$wai.rtl.getTISMapGroups=function(t){var e=[],i="",o=!1;if($.ajax({type:"POST",url:t,dataType:"xml",async:!1,timeout:1500,error:function(t,e,i){o=!0},success:function(t,e,o){i=t}}),o)return e;var n=$.xml2json(i);if(void 0!==n.InOutInfo&&null!==n.InOutInfo&&""!=n.InOutInfo){var a=n.InOutInfo,r=[],s=[];void 0!==a.InputData&&null!==a.InputData&&""!=a.InputData&&(void 0===a.InputData.ParamInfo.length?r.push(a.InputData.ParamInfo):r=a.InputData.ParamInfo),void 0!==a.OutputData&&null!==a.OutputData&&""!=a.OutputData&&(void 0===a.OutputData.ParamInfo.length?s.push(a.OutputData.ParamInfo):s=a.OutputData.ParamInfo);for(var l=0;l<r.length;l++){var h=[];void 0===r[l].FieldInfo.length?h.push(r[l].FieldInfo):h=r[l].FieldInfo;var c={type:"input",name:r[l].name,field:h};e.push(c)}for(l=0;l<s.length;l++){h=[];void 0===s[l].FieldInfo.length?h.push(s[l].FieldInfo):h=s[l].FieldInfo;c={type:"output",name:s[l].name,field:h};e.push(c)}}return e};$wai.rtl.dataServiceInfoToTag=function(t){for(var e="  <DataServices>\n",i=0;i<t.length;i++){t[i];var o='    <dataService id="'+t[i].id+'" ';for(var n in t[i])"id"!=n&&(o+=n+'="'+t[i][n]+'" ');e=e+"    "+(o=o.trim())+"></dataService>\n"}return e+="  </DataServices>\n"};$wai.rtl.getCustScriptFunctions=function(t){var e=[],i=window;for(var o in void 0!==t&&(i=t),i){if(i.hasOwnProperty(o)&&"function"==typeof i[o])if(!/\[native code\]/.test(i[o].toString())){var n=[],a=i[o].prototype.constructor+"",r=(a=a.substr(0,a.indexOf("{"))).substr(a.indexOf("(")+1,a.lastIndexOf(")")-a.indexOf("(")-1),s="";if(""!=r)for(var l=r.split(","),h=0;h<l.length;h++)""!=l[h].trim()&&(n.push(l[h].trim()),""!=s&&(s+=", "),s+=l[h].trim());var c="function "+o+"("+s+")";e.push({name:o,args:n,funcText:c,funcInst:i[o]})}}return e};$wai.classes.canvasScrollbar=function(){var t=this;this.value=0,this.visible=!1,this.option={direction:"vert",drawRect:{left:0,top:0,right:0,bottom:0,width:0,height:0},drawCtx:null,maxPos:100,curSize:10,value:0,disable:!1,images:null,onUpBtnClick:null,onDownBtnClick:null,onScroll:null,onRedrawed:null};var e=null,i=null,o={btn1:[0,0,0,0],btn2:[0,0,0,0],cursor:[0,0,0,0],cursorBefore:[0,0,0,0],cursorAfter:[0,0,0,0]};this.style={border:["#EAEAEA"],bgColor:["#EAEAEA"],btnBg:["#C0C0C0"],btnBgOn:["#C0C0FF"],psColor:["#909090"],psColorOn:["#A0A0B0"],psBorder:["#404040"]},this.init=function(t){for(var o in null==e&&(e=document.createElement("canvas")),this.option)void 0!==t[o]&&(this.option[o]=t[o]);if(this.option.drawRect.right=this.option.drawRect.left+this.option.drawRect.width,this.option.drawRect.bottom=this.option.drawRect.top+this.option.drawRect.height,e.width=this.option.drawRect.width,e.height=this.option.drawRect.height,i=e.getContext("2d"),void 0!==this.option.value&&(this.value=this.option.value),void 0!==this.option.disable&&(this.disable=this.option.disable),void 0!==t.style&&typeof t.style==typeof{})for(var a in t.style)this.style[a]=t.style[a];n.onOver=!1,n.onItem="",this.visible=!0},this.redraw=function(){var t=this.option.drawRect,r=this.style;$wai.rtl.style.setFillStyle(i,r.border,t),i.fillRect(0,0,t.width,t.height),$wai.rtl.style.setFillStyle(i,r.bgColor,t),i.fillRect(1,1,t.width-2,t.height-2);var s=[0,0,0,0],l=[0,0,0,0],h=0,c=0;"horz"==this.option.direction.toLowerCase()?(s=[1,1,t.height-2,t.height-2],l=[t.width-t.height,1,t.height-1,t.height-2],h=t.height-2,c=t.width-2-2*t.height):(s=[1,1,t.width-2,t.width-2],l=[1,t.height-t.width,t.width-2,t.width-1],h=t.width-2,c=t.height-2-2*t.width);var d=c/this.option.maxPos*this.option.curSize;d>h&&(h=Math.floor(d));var u=Math.round((c-h)/(this.option.maxPos-this.option.curSize)*this.value);if(a.tick=(c-h)/(this.option.maxPos-this.option.curSize),a.tick<=0&&(a.tick=1),"horz"==this.option.direction.toLowerCase()?(o.cursor=[1+s[2]+u,1,4+h,s[3]],o.cursorBefore=[t.height-1,1,u,s[3]],o.cursorAfter=[s[2]+u+h+5,1,t.width-t.height,s[3]]):(o.cursor=[1,1+s[3]+u,s[2],4+h],o.cursorBefore=[1,t.width-1,s[2],u],o.cursorAfter=[1,s[3]+u+h+5,s[2],t.height-t.width]),null==r.psBorder&&(r.psBorder=r.psColor),$wai.rtl.style.setFillStyle(i,r.psBorder,t),i.fillRect(o.cursor[0],o.cursor[1],o.cursor[2],o.cursor[3]),n.onOver&&"cursor"==n.onItem?$wai.rtl.style.setFillStyle(i,r.psColorOn,t):$wai.rtl.style.setFillStyle(i,r.psColor,t),i.fillRect(o.cursor[0]+1,o.cursor[1]+1,o.cursor[2]-2,o.cursor[3]-2),o.btn1=s,o.btn2=l,n.onOver&&"btn1"==n.onItem?$wai.rtl.style.setFillStyle(i,r.btnBgOn,t):$wai.rtl.style.setFillStyle(i,r.btnBg,t),i.fillRect(s[0],s[1],s[2],s[3]),n.onOver&&"btn2"==n.onItem?$wai.rtl.style.setFillStyle(i,r.btnBgOn,t):$wai.rtl.style.setFillStyle(i,r.btnBg,t),i.fillRect(l[0],l[1],l[2],l[3]),void 0!==this.option.images&&null!=this.option.images){var f=this.option.images,p="horz"==this.option.direction.toLowerCase()?0:1,g=f.getIconCanvas(16,16,0,0+p),v=f.getIconCanvas(16,16,0,2+p);try{i.drawImage(g,s[0]+(s[2]/2-g.width/2),s[1]+(s[3]/2-g.height/2)),i.drawImage(v,l[0]+(l[2]/2-v.width/2),l[1]+(l[3]/2-v.height/2))}catch(t){}}if(this.disable){i.fillStyle="rgba(150,150,150,0.5)";t=this.option.drawRect;i.fillRect(0,0,t.width,t.height)}e.width<=0&&(e.width=1),this.option.drawCtx.drawImage(e,t.left,t.top),void 0!==this.option.onRedrawed&&null!=this.option.onRedrawed&&this.option.onRedrawed(e,t.left,t.top)},this.doMouseMove=function(t,e){if(this.visible){var i=0,a=0;if(null!=e)i=e.x,a=e.y;else{if(null==t)return;i=t.offsetX,a=t.offsetY}var r=this.option.drawRect,s=[];for(var l in o){var h=o[l][0]+r.left,c=o[l][1]+r.top,d={n:l,r:[h,c,h+o[l][2],c+o[l][3]]};s.push(d)}for(var u=!1,f=0;f<s.length;f++){var p=s[f].r,g=p[0]<=i&&p[2]>=i,v=p[1]<=a&&p[3]>=a;if(g&&v){n.onItem!=s[f].n&&(n.onItem=s[f].n,n.onOver=!0,this.redraw()),u=!0;break}}u||this.doMouseOut()}},this.doMouseOut=function(){d(),n.onOver&&(n.onItem="",n.onOver=!1,this.redraw())};var n={onOver:!1,onItem:""},a={drag:!1,tick:0,start:{x:0,y:0,value:0}};function r(e){if(void 0===e&&(e=window.event),0==e.buttons)return s(e),e.preventDefault(),!1;var i=1,o=0;"horz"==t.option.direction?e.pageX<a.start.x?(i=-1,o=Math.round((a.start.x-e.pageX)/a.tick)):o=Math.round((e.pageX-a.start.x)/a.tick):e.pageY<a.start.y?(i=-1,o=Math.round((a.start.y-e.pageY)/a.tick)):o=Math.round((e.pageY-a.start.y)/a.tick);var n=a.start.value+o*i;return n>t.option.maxPos-t.option.curSize?n=t.option.maxPos-t.option.curSize:n<0&&(n=0),n!=t.value&&(t.value=n,t.onScroll(),t.redraw()),e.preventDefault(),!1}function s(e){void 0===e&&(e=window.event),a.drag=!1,document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s),t.doMouseEventProc(0,"mousemove",e)}this.disable=!1,this.setDisable=function(t){this.disable!=t&&(this.disable=t,this.redraw())},this.onScroll=function(){void 0!==this.option.onScroll&&null!=this.option.onScroll&&this.option.onScroll(this)},this.scrollUp=function(){this.value-=1,this.value<0&&(this.value=0),this.redraw(),void 0!==this.option.onUpBtnClick&&null!=this.option.onUpBtnClick&&this.option.onUpBtnClick(this)},this.scrollDown=function(){this.value+=1,this.value>this.option.maxPos-this.option.curSize&&(this.value=this.option.maxPos-this.option.curSize),this.redraw(),void 0!==this.option.onDownBtnClick&&null!=this.option.onDownBtnClick&&this.option.onDownBtnClick(this)};var l=null,h=null;function c(t,e){l=window.setTimeout(u,500,t,e)}function d(){window.clearTimeout(l),window.clearInterval(h)}function u(t,e){h=window.setInterval(f,50,t,e)}function f(e,i){"btn1"==n.onItem?t.scrollUp():"btn2"==n.onItem?t.scrollDown():"cursorBefore"==n.onItem?(t.scrollUp(),t.doMouseMove(e,i)):"cursorAfter"==n.onItem&&(t.scrollDown(),t.doMouseMove(e,i))}this.doMouseEventProc=function(t,e,i,o){var l=!1;if(this.disable)return!1;if(a.drag)return!0;if(null!=i){var h=0,u=0;null!=o?(h=o.x,u=o.y):(h=i.offsetX,u=i.offsetY);var f=this.option.drawRect,p=f.left<=h&&f.right>=h,g=f.top<=u&&f.bottom>=u;if(p&&g){switch(t){case 0:this.doMouseMove(i,o);break;case 1:n.onOver&&("btn1"==n.onItem?(this.scrollUp(),c()):"btn2"==n.onItem?(this.scrollDown(),c()):"cursor"==n.onItem?(a.drag=!0,a.start.x=i.pageX,a.start.y=i.pageY,a.start.value=this.value,document.addEventListener("mousemove",r),document.addEventListener("mouseup",s)):"cursorBefore"==n.onItem?(this.scrollUp(),c(i,o)):"cursorAfter"==n.onItem&&(this.scrollDown(),c(i,o)));break;case 2:d()}l=!0}else this.doMouseOut();return l}}};$wai.classes.canvasToolbar=function(){this.disable=!1,this.option={buttons:[],disable:!1,direction:"horz",drawRect:{left:0,top:0,right:0,bottom:0,width:0,height:0},drawCtx:null,iconSize:{w:16,h:16},iconMargin:0,hintCanvas:null,autoSize:!0,icons:null,onMouseEvent:null,onRedrawed:null},this.style={bgColor:"white",overBgColor:["rgba(160,160,255,0.2)","rgba(160,160,255,0.3)","rgba(160,160,255,0.5)"],checkColor:["rgba(255,160,160,0.2)","rgba(255,160,160,0.3)","rgba(255,160,160,0.5)"]};var t=null,e=null,i=-1,o="";this.inited=!1,this.init=function(n){for(var a in null==t&&(t=document.createElement("canvas")),i=-1,this.option)void 0!==n[a]&&(this.option[a]=n[a]);if(1==this.option.autoSize){var r=this.option.drawRect,s=this.option.iconSize,l=("horz"==this.option.direction?r.height>s.w?r.height:s.w:r.width>s.h?r.width:s.h)*this.option.buttons.length+this.option.iconMargin*(this.option.buttons.length-1);"horz"==this.option.direction?this.option.drawRect.width=l+1:this.option.drawRect.height=l+1}if(this.option.drawRect.right=this.option.drawRect.left+this.option.drawRect.width,this.option.drawRect.bottom=this.option.drawRect.top+this.option.drawRect.height,t.width=this.option.drawRect.width,t.height=this.option.drawRect.height,e=t.getContext("2d"),void 0!==n.style&&typeof n.style==typeof{})for(var h in n.style)this.style[h]=n.style[h];if(this.disable=void 0!==n.disable&&n.disable,null!=this.option.hintCanvas&&void 0!==this.option.hintCanvas)try{o=this.option.hintCanvas.title}catch(t){console.error(t.message)}},this.redraw=function(){var o=this.option.icons,n=this.option.iconMargin,a=this.option.drawRect,r=this.option.iconSize,s=0,l=0;l="horz"==this.option.direction?a.height>r.w?a.height:r.w:a.width>r.h?a.width:r.h,""!=this.style.bgColor?($wai.rtl.style.setFillStyle(e,this.style.bgColor,a),e.fillRect(0,0,a.width-1,a.height-1)):e.clearRect(0,0,a.width-1,a.height-1);for(var h=0;h<this.option.buttons.length;h++){var c=this.option.buttons[h].iconIndex;if(null!=o&&void 0!==o)if("horz"==this.option.direction){if(h==i&&(""!=this.style.overBgColor&&($wai.rtl.style.setFillStyle(e,this.style.overBgColor,{top:0,bottom:a.height-1}),$wai.rtl.draw.roundRect(e,s,0,l,a.height-1,void 0,!0,!1)),null!=this.option.hintCanvas&&void 0!==this.option.hintCanvas))try{this.option.hintCanvas.title=this.option.buttons[h].hint}catch(t){console.error(t.message)}o.drawIcon(r.w,r.h,c.r,c.c,e,s+(l/2-r.w/2)-1,a.height/2-r.h/2-1)}else{if(h==i&&(""!=this.style.overBgColor&&($wai.rtl.style.setFillStyle(e,this.style.overBgColor,{top:s,bottom:s+l-1}),$wai.rtl.draw.roundRect(e,0,s,a.width-1,l,void 0,!0,!1)),null!=this.option.hintCanvas&&void 0!==this.option.hintCanvas))try{this.option.hintCanvas.title=this.option.buttons[h].hint}catch(t){console.error(t.message)}o.drawIcon(r.w,r.h,c.r,c.c,e,a.width/2-r.w/2,s+(l/2-r.h/2))}s+=l+n}if(this.disable){e.fillStyle="rgba(150,150,150,0.5)";a=this.option.drawRect;e.fillRect(0,0,a.width,a.height)}t.width<=0&&(t.width=1),this.option.drawCtx.drawImage(t,a.left,a.top),void 0!==this.option.onRedrawed&&null!=this.option.onRedrawed&&this.option.onRedrawed(t,a.left,a.top)},this.mouseEventsDistribute=function(t,e,o){var n=!0;if(i<0)return n;var a=void 0!==this.option.onMouseEvent&&null!=this.option.onMouseEvent?this.option.onMouseEvent:null;return null!=a&&(n=a({id:t,name:e,event:o},this.option.buttons[i],this)),n},this.doMouseEventProc=function(t,e,i,o){if(this.disable)return!1;var n=0,a=0;null!=o?(n=o.x,a=o.y):(n=i.offsetX,a=i.offsetY);var r=this.option.drawRect,s=r.left<=n&&r.right>=n,l=r.top<=a&&r.bottom>=a;if(s&&l)switch(t){case 0:this.doMouseMove(i,o);break;case 1:this.mouseEventsDistribute(2,"mousedown",i);break;case 2:this.mouseEventsDistribute(3,"mouseup",i);break;case 3:break;case 4:this.mouseEventsDistribute(5,"dblclick",i)}else this.doMouseOut(i)},this.doMouseMove=function(t,e){var o=0,n=0;null!=e?(o=e.x,n=e.y):(o=t.offsetX,n=t.offsetY);var a=this.option.iconMargin,r=this.option.drawRect,s=this.option.iconSize,l=0,h=0;h="horz"==this.option.direction?r.height>s.w?r.height:s.w:r.width>s.h?r.width:s.h;for(var c=!1,d=0;d<this.option.buttons.length;d++){var u=null,f=(u="horz"==this.option.direction?[r.left+l,r.top,r.left+l+h,r.bottom]:[r.left,r.top+l,r.right,r.top+l+h])[0]<=o&&u[2]>=o,p=u[1]<=n&&u[3]>=n;if(f&&p){d!=i&&(i=d,this.mouseEventsDistribute(0,"mouseover",t),this.redraw()),c=!0;break}l+=h+a}c||this.doMouseOut(t)},this.doMouseOut=function(t){if(!(i<0)){if(null!=this.option.hintCanvas&&void 0!==this.option.hintCanvas)try{this.option.hintCanvas.title=o}catch(t){console.error(t.message)}this.mouseEventsDistribute(1,"mouseout",t),i=-1,this.redraw()}}};$wai.classes.canvasTabCtrl=function(t,e){this.id=t.id;var i={lockable:!1,closable:!0,icons:null,iconSize:16,tabs:[],tabMargin:5,fitWidth:!1,emptyElem:void 0,style:{borderColor:"#808080",bgColor:"#eaeaea",tabOff:"#D2D1D0",tabOn:"white",font:"12px tahoma",fontColor:"black"},onMouseEvent:void 0,onClick:void 0,onContext:void 0,onChanging:void 0,onClosing:void 0,onMore:void 0,onCloseIcon:void 0};for(var o in this.option=JSON.parse(JSON.stringify(i)),e)"style"!=o&&(this.option[o]=e[o]);if(void 0!==e.style)for(var n in e.style)this.option.style[n]=e.style[n];var a=this;this.getStyle=function(t,e){var i,o=(t.ownerDocument||document).defaultView;return o&&o.getComputedStyle?(e=e.replace(/([A-Z])/g,"-$1").toLowerCase(),o.getComputedStyle(t,null).getPropertyValue(e)):t.currentStyle?(e=e.replace(/\-(\w)/g,(function(t,e){return e.toUpperCase()})),i=t.currentStyle[e],/^\d+(em|pt|%|ex)?$/i.test(i)?function(e){var i=t.style.left,o=t.runtimeStyle.left;return t.runtimeStyle.left=t.currentStyle.left,t.style.left=e||0,e=t.style.pixelLeft+"px",t.style.left=i,t.runtimeStyle.left=o,e}(i):i):void 0};var r=this.getStyle(t,"width"),s=this.getStyle(t,"height");$(t).replaceWith('<div id="'+this.id+'_tabctrl_Div" style="'+t.style.cssText+'">\n  <input type="text" id="'+this.id+'_tabctrl_key" value="" style="z-index:-1000;position:absolute;top:-5000px;left:-5000px">\n  <canvas id="'+this.id+'_tabctrl_canvas" width="'+r+'" height="'+s+'" class="" style="width:100%;height:100%;border:none" onselectstart="return false;"></canvas>\n</div>'),window[this.id]=this,this.tcDiv=$("#"+this.id+"_tabctrl_Div"),this.tcKey=$("#"+this.id+"_tabctrl_key"),this.tcCanvas=$("#"+this.id+"_tabctrl_canvas"),this.ctx=this.tcCanvas[0].getContext("2d"),this.width=this.tcCanvas[0].width,this.height=this.tcCanvas[0].height,this.init=function(){for(var t=this.option.tabs,e=0;e<t.length;e++)this.addTab(t[e]);this.tabs.length>0&&(this.curOnTab=0,this.pageDisplayCtrl()),this.draw()},window.addEventListener("resize",(function(t){try{var e=a.getStyle(a.tcDiv[0],"width"),i=a.getStyle(a.tcDiv[0],"height");a.width=parseInt(e.substr(0,e.indexOf("px"))),a.height=parseInt(i.substr(0,i.indexOf("px"))),a.tcCanvas[0].width=a.width,a.tcCanvas[0].height=a.height,a.ctx=a.tcCanvas[0].getContext("2d"),a.draw()}catch(t){console.log(t.message)}}));var l={id:0,text:"",img:"",isLocked:!1,visible:!0,pageElem:void 0,data:void 0},h=function(t){this.id=t.id,this.text=t.text,this.data=t.data,this.img=t.img,this.visible=t.visible,this.isShow=!0,this.isLocked=t.isLocked,this.isCloseOver=!1,this.pageElem=t.pageElem,this.rect={l:0,t:0,w:0,h:0,r:0,b:0,tL:0,tT:0}};this.tabs=[],this.addTab=function(t,e){var i=JSON.parse(JSON.stringify(l));for(var o in t)i[o]=t[o];this.tabs.push(new h(i)),!0===e?(this.curOnTab=this.tabs.length-1,this.selectTab(this.tabs[this.curOnTab].id,!0)):(f&&this._draw(),this.pageDisplayCtrl()),void 0!==this.option.emptyElem&&(this.option.emptyElem.style.display=this.tabs.length>0?"none":"")},this.insertTab=function(t,e){var i=JSON.parse(JSON.stringify(l));for(var o in t)i[o]=t[o];this.curOnTab>=0?(this.tabs.splice(this.curOnTab+1,0,new h(i)),!0===e&&(this.curOnTab++,this.selectTab(this.tabs[this.curOnTab].id,!0))):(this.tabs.push(new h(i)),!0===e&&(this.curOnTab=this.tabs.length-1,this.selectTab(this.tabs[this.curOnTab].id,!0))),void 0!==this.option.emptyElem&&(this.option.emptyElem.style.display=this.tabs.length>0?"none":"")},this.clearTab=function(){for(var t=0;t<this.tabs.length;t++){var e=this.tabs[t].pageElem;null!=e&&$(e).remove()}this.tabs=[],this.curOnTab=-1,f&&this._draw()},this.closeAll=function(t){for(var e=new Array,i=this.tabs.length-1;i>=0;i--){var o=void 0,n=this.tabs[i],a=JSON.parse(JSON.stringify(this.tabs[i]));if(e.push(a),!0===t){if(void 0!==this.option.onChanging&&null!=this.option.onChanging){var r=null;this.curOnTab>=0&&(r=this.tabs[this.curOnTab]),o=null!=r?r.id!==n.id&&this.option.onChanging(null,r,this.tabs[i]):this.option.onChanging(null,r,this.tabs[i])}!1!==o&&(this.curOnTab=i,this.pageDisplayCtrl(),this.draw())}if(void 0!==this.option.onClosing&&null!=this.option.onClosing&&(o=this.option.onClosing(null,n)),!1===o)break;this.delTabOfID(n.id),this.draw()}return e},this.closeOther=function(){for(var t=new Array,e=this.tabs.length-1;e>=0;e--)if(this.curOnTab!=e){var i=void 0,o=this.tabs[e],n=JSON.parse(JSON.stringify(this.tabs[e]));if(t.push(n),void 0!==this.option.onClosing&&null!=this.option.onClosing&&(i=this.option.onClosing(null,o)),!1===i)break;this.curOnTab>e&&(this.curOnTab=e),this.delTabOfID(o.id)}return t},this.getTab=function(t){for(var e=null,i=0;i<this.tabs.length;i++)if(this.tabs[i].id==t){e=this.tabs[i];break}return e},this.getTabIndex=function(t){for(var e=-1,i=0;i<this.tabs.length;i++)if(this.tabs[i].id==t){e=i;break}return e},this.getCurrentTab=function(){var t=null;return this.curOnTab>=0&&(t=this.tabs[this.curOnTab]),t},this.getHiddenTabs=function(){for(var t=[],e=0;e<this.tabs.length;e++)!1===this.tabs[e].isShow&&this.tabs[e].visible&&t.push(this.tabs[e]);return t},this.closeCurrent=function(){var t=new Array;if(this.curOnTab>=0){var e=JSON.parse(JSON.stringify(this.tabs[this.curOnTab]));this.closeTab(this.tabs[this.curOnTab].id),t.push(e)}else console.warn("TabCtrl.closeCurrent : Can not close current tab (selected tab not found)");return t},this.closeTab=function(t,e){var i=this.getTab(t);if(null!=i){if(!0===e){var o=this.getTabIndex(t);if(!this.tabs[o].visible){if(void 0!==this.option.onChanging&&null!=this.option.onChanging){var n=null;this.curOnTab>=0&&(n=this.tabs[this.curOnTab]),null!=n?n.id!==i.id?rt=this.option.onChanging(null,n,this.tabs[o]):rt=!1:rt=this.option.onChanging(null,n,this.tabs[o])}!1!==rt&&(this.curOnTab=o,this.draw(),this.pageDisplayCtrl())}}void 0!==this.option.onClosing&&null!=this.option.onClosing&&(rt=this.option.onClosing(null,i)),!1!==rt&&(this.delTabOfID(i.id),this.draw())}else console.warn("TabCtrl.closeTab : Can not close tab (tab not found : "+t+")")},this.selectTab=function(t,e){for(var i=-1,o=0;o<this.tabs.length;o++)if(this.tabs[o].id==t){i=o;break}if(this.tabs[i].visible){var n=this.curOnTab!=i;if(!0===e&&(n=!0),i>=0&&n){var a=void 0;if(void 0!==this.option.onChanging&&null!=this.option.onChanging){var r=null;this.curOnTab>=0&&(r=this.tabs[this.curOnTab]),a=this.option.onChanging(null,r,this.tabs[i])}!1!==a&&(this.curOnTab=i,this.pageDisplayCtrl(),this.draw())}else i<0&&console.warn("TabCtrl.selectTab : Can not select tab (tab not found : "+t+")")}else console.warn('TabCtrl.selectTab : Can not select tab. "'+t+'" is not visible')},this.pageDisplayCtrl=function(){for(var t=0;t<this.tabs.length;t++){var e=this.tabs[t].pageElem;this.curOnTab!=t?$(e).css("display","none"):$(e).css("display","")}void 0!==this.option.emptyElem&&(this.option.emptyElem.style.display=this.tabs.length>0?"none":"")},this.delTabOfID=function(t){for(var e=-1,i=0;i<this.tabs.length;i++)if(this.tabs[i].id==t){e=i;break}e>=0&&this.delTabOfIndex(e)},this.delTabOfIndexX=function(t){var e=this.tabs[t].pageElem;$(e).remove(),this.tabs.splice(t,1),d(),this.pageDisplayCtrl()},this.delTabOfIndex=function(t){var e=this.tabs[t].pageElem;if("IFRAME"===(e.tagName+"").trim().toUpperCase()){var i=!1;try{var o=(void 0!==e.contentWindow?e.contentWindow:e).document.body,n=$(o).find("iframe");i=n.length>0;for(var a=0;a<n.length;a++){var r=n[a];$(r).attr("src","about:blank")}}catch(t){console.log("delTabOfIndex.child.iframe",t)}if(i)e.style.display="none",window.setTimeout((function(){$(e).attr("src","about:blank"),window.setTimeout((function(){console.log("IFRAME and SubIFrame Removed"),$(e).remove()}),1e3)}),1e3);else{try{e.style.display="none",$(e).attr("src","about:blank")}catch(t){console.log("delTabOfIndex",t)}window.setTimeout((function(){$(e).remove()}),1e3)}}else $(e).remove();this.tabs.splice(t,1),d(),this.pageDisplayCtrl()};var c=30;function d(){if(a.curOnTab>a.tabs.length-1&&(a.curOnTab=a.tabs.length-1),a.curOnTab>=0){var t=void 0;void 0!==a.option.onChanging&&null!=a.option.onChanging&&(t=a.option.onChanging(null,null,a.tabs[a.curOnTab])),!1!==t&&(a.curOnTab=a.curOnTab,a.draw())}}this.calcTabPosSize=function(t){var e=0,i=null,o=void 0!==this.option.icons&&null!=this.option.icons?this.option.iconSize:0,n=1==this.option.closable?this.option.iconSize:0,a=2*this.option.tabMargin+(o+n)+6;this.ctx.font=this.option.style.font,this.ctx.fillStyle=this.option.style.fontColor;for(var r=0,s=0;s<t.length;s++)(i=t[s]).visible&&(i.rect.l=e,i.rect.t=0,i.rect.w=this.ctx.measureText(i.text).width+a+1,i.rect.h=this.height,i.rect.r=i.rect.l+i.rect.w,i.rect.b=i.rect.t+i.rect.h,i.rect.tL=i.rect.l+this.option.tabMargin+o+3,i.rect.tT=i.rect.h/2+6,e+=i.rect.w,r++),i.isShow=!0;if(e<this.width){if(1==this.option.fitWidth){var l=this.width-e,h=Math.floor(l/r),d=l%r;e=0;for(s=0;s<t.length;s++)(i=t[s]).visible&&(i.rect.l=e,i.rect.w+=h,i.rect.r=i.rect.l+i.rect.w,i.rect.tL=i.rect.l+this.option.tabMargin+o+3,e+=i.rect.w);for(s=t.length-1;s>=0;s--)if((i=t[s]).visible){i.rect.w+=d+1;break}}}else{for(s=t.length-1;s>=0;s--)if(t[s].visible){if(this.curOnTab==s)break;if((i=t[s]).isShow=!1,(e-=i.rect.w)+c<this.width)break}if(!(e+c<this.width)){for(s=0;s<t.length;s++)if(t[s].visible){if(this.curOnTab==s)break;if((i=t[s]).isShow=!1,(e-=i.rect.w)+c<this.width)break}e=0;for(s=0;s<t.length;s++)(i=t[s]).visible&&i.isShow&&(i.rect.l=e,i.rect.t=0,i.rect.w=this.ctx.measureText(i.text).width+a+1,i.rect.h=this.height,i.rect.r=i.rect.l+i.rect.w,i.rect.b=i.rect.t+i.rect.h,i.rect.tL=i.rect.l+this.option.tabMargin+o+3,i.rect.tT=i.rect.h/2+6,e+=i.rect.w)}}},this.curOnTab=-1;var u=null;this.draw=function(){try{void 0!==a.option.icons&&null!=a.option.icons?a.option.icons.loaded?(window.clearInterval(u),a._draw()):u=window.setInterval(this.draw,50):a._draw()}catch(t){console.log(t.message),window.clearInterval(u)}};var f=!1,p=[];this._draw=function(){this.calcTabPosSize(this.tabs);var t=null,e=this.ctx,i=this.option.icons;e.fillStyle=this.option.style.bgColor,e.fillRect(0,0,this.width,this.height),p=[];for(var o=0,n=0;n<this.tabs.length;n++)if(this.tabs[n].visible)if(this.tabs[n].isShow){if(t=this.tabs[n].rect,e.fillStyle=this.option.style.borderColor,e.fillRect(t.l,t.t,t.w,t.h),this.curOnTab==n?(e.fillStyle=this.option.style.tabOn,e.fillRect(t.l,t.t,t.w-1,t.h)):(e.fillStyle=this.option.style.tabOff,e.fillRect(t.l,t.t,t.w-1,t.h-1)),void 0!==this.option.icons&&null!=this.option.icons&&i.draw(this.tabs[n].img,e,t.l+this.option.tabMargin,t.h/2-this.option.iconSize/2),this.option.closable){var a=this.tabs[n].isCloseOver?"_closeOver":"_close";i.draw(a,e,t.r-this.option.tabMargin-this.option.iconSize,t.h/2-this.option.iconSize/2),p.push({l:t.r-this.option.tabMargin-this.option.iconSize,r:t.r-this.option.tabMargin,tab:this.tabs[n]})}e.font=this.option.style.font,e.fillStyle=this.option.style.fontColor,e.textAlign="left",e.fillText(this.tabs[n].text,t.tL,t.tT)}else o++;o>0&&(i.draw("_more",e,this.width-c,this.height/2-this.option.iconSize/2),e.font="9px arial",e.fillStyle=this.option.style.fontColor,e.textAlign="left",e.fillText(o+"",this.width-14,this.height/2+4.5,this.option.iconSize),p.push({l:this.width-c,r:this.width-c+this.option.iconSize,tab:"_more"})),f=!0},this.tcCanvas.bind("mousemove",(function(t){a.mouseEventsDistribute("mousemove",t)})),this.tcCanvas.bind("mousedown",(function(t){a.mouseEventsDistribute("mousedown",t)})),this.tcCanvas.bind("mouseup",(function(t){a.mouseEventsDistribute("mouseup",t)})),this.tcCanvas.bind("click",(function(t){a.mouseEventsDistribute("click",t)})),this.tcCanvas.bind("dblclick",(function(t){a.mouseEventsDistribute("dblclick",t)})),this.tcCanvas.bind("mouseout",(function(t){a.mouseEventsDistribute("mouseout",t)})),this.tcCanvas.bind("contextmenu",(function(t){a.mouseEventsDistribute("contextmenu",t)})),this.getEventedTab=function(t){for(var e=-1,i=null,o=0;o<this.tabs.length;o++)if(this.tabs[o].visible&&this.tabs[o].isShow){i=this.tabs[o].rect;var n=t.offsetX>=i.l&&t.offsetX<=i.r,a=t.offsetY>=i.t&&t.offsetY<=i.b;if(n&&a){e=o;break}}return e},this.getEventRectTab=function(t){for(var e=null,i=null,o=0;o<p.length;o++)if(i=p[o],t.offsetX>=i.l&&t.offsetX<=i.r){e=i;break}return e},this.mouseEventsDistribute=function(t,e){var i=["mousemove","mousedown","mouseup","click","dblclick","mouseout","contextmenu"],o=function(t){for(var e in i)if(i[e]==t)return parseInt(e)}(t);switch(o){case 0:if(null!=(c=this.getEventRectTab(e))){if("_more"!=c.tab){for(var n=0;n<this.tabs.length;n++)this.tabs[n].isCloseOver=!1;c.tab.isCloseOver=!0,this.draw()}}else{var r=!1;for(n=0;n<this.tabs.length;n++)r|=this.tabs[n].isCloseOver,this.tabs[n].isCloseOver=!1;r&&this.draw()}break;case 1:case 4:break;case 2:if(0==e.button)if(null!=(c=this.getEventRectTab(e))){if("_more"!=c.tab){var s=void 0;if(void 0!==this.option.onClosing&&null!=this.option.onClosing)return void this.option.onCloseIcon(e,c.tab);!1!==s&&(this.curOnTab>this.getTabIndex(c.tab.id)&&this.curOnTab--,this.delTabOfID(c.tab.id),this.draw())}}else if((d=this.getEventedTab(e))>=0&&this.curOnTab!=d){s=void 0;if(void 0!==this.option.onChanging&&null!=this.option.onChanging){var l=null;this.curOnTab>=0&&(l=this.tabs[this.curOnTab]),s=this.option.onChanging(e,l,this.tabs[d])}!1!==s&&(this.curOnTab=d,this.pageDisplayCtrl(),this.draw())}break;case 3:var h=!1;if(null!=(c=this.getEventRectTab(e))&&"_more"==c.tab){s=void 0;void 0!==this.option.onMore&&null!=this.option.onMore&&(s=this.option.onMore(e,a)),h=!0}if(!h)(d=this.getEventedTab(e))>=0&&void 0!==this.option.onClick&&null!=this.option.onClick&&this.option.onClick(e,this.tabs[d]);return e.preventDefault(),!1;case 5:for(r=!1,n=0;n<this.tabs.length;n++)r|=this.tabs[n].isCloseOver,this.tabs[n].isCloseOver=!1;r&&this.draw();break;case 6:var c,d;h=!1;if(null!=(c=this.getEventRectTab(e))&&"_more"==c.tab){s=void 0;void 0!==this.option.onMore&&null!=this.option.onMore&&(s=this.option.onMore(e,a)),h=!0}if(!h)(d=this.getEventedTab(e))>=0&&void 0!==this.option.onContext&&null!=this.option.onContext&&this.option.onContext(e,this.tabs[d]);return e.preventDefault(),!1}},this.init()};$wai.util=new function(){this.otherParameters=new Array,this.showModalDialogSupported=!0,this.callbackMethod=null,this.dialogArguments=null,this.cacheLoader=[],this.cacheAdder=null,this.getCachedURL=function(t){for(var e=null,i=0;i<this.cacheLoader.length&&(void 0===this.cacheLoader[i]||null===this.cacheLoader[i]||null===(e=JSON.parse(JSON.stringify(this.cacheLoader[i](t)))));i++);return $wai.debug>30&&console.log("$wai.util.getCachedURL : "+t+"\n",e),e},this.setCachedURL=function(t,e){null!==this.cacheAdder&&this.cacheAdder(t,e)},this.showModalDialog=function(t,e,o,n){var a,r,s="no",l="no",h="no",c=o.split(";");for(i=0;i<c.length;i++){var d=c[i].split(":"),u=d[0],f=d[1];u&&(u=u.trim().toLowerCase()),f&&(f=f.trim().toLowerCase()),"dialogheight"==u?r=f.replace("px",""):"dialogwidth"==u?a=f.replace("px",""):"resizable"==u?s=f:"scroll"==u?l=f:"status"==u&&(h=f)}var p=window.screenX+window.outerWidth/2-a/2,g=window.screenY+window.outerHeight/2-r/2,v=window.open(t,"ShowModalDialog"+t,"toolbar=no, location=no, directories=no, status="+h+", menubar=no, scrollbars="+l+", resizable="+s+", copyhistory=no, width="+a+", height="+r+", top="+g+", left="+p);this.dialogArguments=e,this.callbackMethod=null!=n?n:null,v.focus()},this.getDialogArgumentsInner=function(){return this.dialogArguments},this.getCallbackMethodName=function(){return this.callbackMethod},this.getDialogArguments=function(){return opener.$wai.util.dialogArguments},this.setReturnValue=function(t){if(null==opener||opener.closed){if(null!=parent.opener&&!parent.opener.closed){e=parent.opener.$wai.util.getCallbackMethodName();try{null!=e?parent.opener.$wai.util.callbackMethod(t):parent.opener.showModalDialogCallback(t)}catch(t){console.error("There was an error processing the popup. \nError contents : "+t)}}}else{var e=opener.$wai.util.getCallbackMethodName();try{null!=e?opener.$wai.util.callbackMethod(t):opener.showModalDialogCallback(t)}catch(t){console.error("There was an error processing the popup. \nError contents : "+t)}}},this.formText=function(t,e,i){for(var o="",n=0;n<e;n++)o+=" ";return o="r"==i?(o+=t).substr(o.length-e,e):(o=t+o).substr(0,e)},this.json2text=function(t,e,i){var o=160;void 0!==i&&(o=i);var n=[];return function t(e,i,n,a,r){var s=0;for(var l in e)if(typeof e[l]!=typeof{}){if("string"==typeof e[l])if(s>0)n.push(i+',"'+l+'":"'+e[l]+'"');else{var h=i;r>1&&(h=n.pop()),n.push(h+'"'+l+'":"'+e[l]+'"')}else if(s>0)n.push(i+',"'+l+'":'+e[l]);else{h=i;r>1&&(h=n.pop()),n.push(h+'"'+l+'":'+e[l])}s++}for(var l in e)if(typeof e[l]==typeof{}&&null!==e[l]){if(void 0!==e[l].datasets)for(var c=0;c<e[l].datasets.length;c++)void 0!==e[l].datasets[c]&&delete e[l].datasets[c]._meta;var d=JSON.stringify(e[l]),u=void 0!==e[l].length;(d+"").trim().replace(/\t/g,"").length<=o?s>0?a?n.push(i+","+d):n.push(i+',"'+l+'":'+d):a?n.push(i+d):n.push(i+'"'+l+'":'+d):(s>0?u?a?n.push(i+",["):n.push(i+',"'+l+'" : ['):a?n.push(i+",{"):n.push(i+',"'+l+'" : {'):u?a?n.push(i+"["):n.push(i+'"'+l+'" : ['):a?n.push(i+"{"):n.push(i+'"'+l+'" : {'),t(e[l],i+"  ",n,u,r+1),u?n.push(i+"]"):n.push(i+"}")),s++}}(t,e,n,!1,0),n.join("\n")},this.getJSONAttribute=function(t){var e=void 0;return void 0!==t&&(e=JSON.parse(JSON.stringify(t))),e},this.setIframeHtmlText=function(t,e){var i=t,o=null;try{o=i.contentDocument||i.contentWindow.document}catch(t){o=void 0}void 0===o&&(o=i.window.document),o.write(e),o.close()},this.selfReplace=function(t){console.log("$wai.util.selfReplace"),window.setTimeout((function(){try{document.clear()}catch(t){}document.write(t),document.close()}),10)},this.getPageParams=function(){var t=(location.href+"").split("?"),e={};if(t.length>1)for(var i=t[1].split("&"),o=0;o<i.length;o++){var n=i[o].split("=");2==n.length&&(e[n[0]]=decodeURI(n[1]))}return e},this.numberToCurrency=function(t,e,i,o){e=e||".",i=i||",",o=null==o?2:o;var n=t.toFixed(o),a=new RegExp("^(-?\\d{1,3})((?:\\d{3})+)(\\.(\\d{"+o+"}))?$").exec(n);return a?a[1]+a[2].replace(/\d{3}/g,i+"$&")+(a[4]?e+a[4]:""):n.replace(".",e)};var t=function(t,e){var i=new Uint8Array(t.byteLength+e.byteLength);return i.set(new Uint8Array(t),0),i.set(new Uint8Array(e),t.byteLength),i.buffer};if($wai.default.downInfo.hasOwnProperty("dynamicServiceDomain")){var e=$wai.default.downInfo.dynamicServiceDomain.split(",");for(var i in e){var o=e[i].split("=");o[0]==window.location.protocol+"//"+window.location.host&&($wai.default.downInfo.serviceDomain=o[1])}}var n=null;this.FileDownload=function(e){var i="/";if(arguments.length<=0)alert("The Parameter does not exist.");else{for(var o=0;o<arguments.length-1;o++)i+=arguments[o]+"/";if(fileName=arguments[arguments.length-1],i.indexOf("./")>-1)alert("Movement of the parent directory is prohibited. \r\nPlease check your path again.");else{var a=$wai.default.downInfo.webRoots+i;n=new WebSocket($wai.default.downInfo.serviceDomain);var r,s="_"+Math.random().toString(36).substr(2,9);n.binaryType="arraybuffer",n.onopen=function(){var t={cmd:"login",data:s};n.send(JSON.stringify(t)),t={cmd:"fileDownload",target:a,data:"request"},n.send(JSON.stringify(t));var e=document.createElement("div");e.id="dialog",e.title="File Download";var i=document.createElement("div");i.class="progress-label",i.innerHTML=" Starting download...",i.style="font-weight: bold; text-shadow: 1px 1px 0 #fff;",e.appendChild(i);var o=document.createElement("div");o.id="progressbar",o.style="margin-top: 20px;",e.appendChild(o),document.body.appendChild(e),$("#dialog").dialog({autoOpen:!1,closeOnEscape:!1,resizable:!1}),$("#progressbar").progressbar({value:0,change:function(){},complete:function(){}})};var l=0;n.onmessage=function(e){if("object"==typeof e.data)r=null==r?e.data:t(r,e.data),$("#progressbar").progressbar({value:(parseInt(r.byteLength)/parseInt(l)*100).toFixed(0)}),sendMsg={cmd:"fileDownload",target:a,data:"next"},n.send(JSON.stringify(sendMsg));else if("EOF"==e.data){null==r&&(r=new Uint8Array(0));var i=new Blob([r]);if(navigator.appVersion.toString().indexOf(".NET")>0)window.navigator.msSaveBlob(i,fileName);else{var o=document.createElement("a");o.href=window.URL.createObjectURL(i),o.download=fileName,document.body.appendChild(o),o.click()}n.close(),(h=document.getElementById("dialog")).parentNode.parentNode.removeChild(h.parentNode),$(".window-shadow").remove()}else{var s=(e.data+"").split(":");if("info"==s[0])l=s[1],sendMsg={cmd:"fileDownload",target:a,data:"next"},n.send(JSON.stringify(sendMsg));else if("message"==s[0]){var h;(h=document.getElementById("dialog")).parentNode.parentNode.removeChild(h.parentNode),$(".window-shadow").remove(),alert(s[1])}}},n.onclose=function(t){},n.onerror=function(t){alert("ERROR: Check the server daemon.")}}}},this.DataDownload=function(e){var i="/";if(arguments.length<=0)alert("The Parameter does not exist");else{for(var o=0;o<arguments.length-2;o++)i+=arguments[o]+"/";fileName=arguments[arguments.length-2];var a=arguments[arguments.length-1];if(i.indexOf("./")>-1)alert("Movement of the parent directory is prohibited. \r\nPlease check your path again.");else{var r=$wai.default.downInfo.webRoots+i;n=new WebSocket($wai.default.downInfo.serviceDomain);var s,l="_"+Math.random().toString(36).substr(2,9);n.binaryType="arraybuffer",n.onopen=function(){var t={cmd:"login",data:l};n.send(JSON.stringify(t)),t={cmd:"fileDownload",target:r,data:"request"},n.send(JSON.stringify(t));var e=document.createElement("div");e.id="dialog",e.title="File Download";var i=document.createElement("div");i.class="progress-label",i.innerHTML=" Starting download...",i.style="font-weight: bold; text-shadow: 1px 1px 0 #fff;",e.appendChild(i);var o=document.createElement("div");o.id="progressbar",o.style="margin-top: 20px;",e.appendChild(o),document.body.appendChild(e),$("#dialog").dialog({autoOpen:!1,closeOnEscape:!1,resizable:!1}),$("#progressbar").progressbar({value:0,change:function(){},complete:function(){}})};var h=0;n.onmessage=function(e){if("object"==typeof e.data)s=null==s?e.data:t(s,e.data),$("#progressbar").progressbar({value:(parseInt(s.byteLength)/parseInt(h)*100).toFixed(0)}),sendMsg={cmd:"fileDownload",target:r,data:"next"},n.send(JSON.stringify(sendMsg));else if("EOF"==e.data){null==s&&(s=new Uint8Array(0));for(var i="",o=new Uint8Array(s),l=o.byteLength,c=0;c<l;c++)i+=String.fromCharCode(o[c]);a(fileName,window.btoa(i)),n.close(),(u=document.getElementById("dialog")).parentNode.parentNode.removeChild(u.parentNode),$(".window-shadow").remove()}else{var d=(e.data+"").split(":");if("info"==d[0])h=d[1],sendMsg={cmd:"fileDownload",target:r,data:"next"},n.send(JSON.stringify(sendMsg));else if("message"==d[0]){var u;(u=document.getElementById("dialog")).parentNode.parentNode.removeChild(u.parentNode),$(".window-shadow").remove(),alert(d[1])}}},n.onclose=function(t){},n.onerror=function(t){alert("ERROR: Check the server daemon.")}}}},this.FileUpload=function(t){var e="";if(arguments.length<=0)alert("The Parameter does not exist.");else{for(var i=0;i<arguments.length-1;i++)e+=arguments[i]+"/";if(e=e.substr(0,e.length-1),file=arguments[arguments.length-1],e.indexOf("./")>-1)alert("Movement of the parent directory is prohibited. \r\nPlease check your path again.");else{var o=$wai.default.downInfo.webRoots+e;n=new WebSocket($wai.default.downInfo.serviceDomain);var a="_"+Math.random().toString(36).substr(2,9);n.binaryType="arraybuffer",n.onopen=function(){var t={cmd:"login",data:a};n.send(JSON.stringify(t)),t={cmd:"fileUpload",target:o,data:"_"},n.send(JSON.stringify(t));var e=new FileReader,i=new ArrayBuffer;e.loadend=function(){},e.onload=function(t){i=t.target.result,n.send(i),n.close()},e.readAsArrayBuffer(file)},n.onmessage=function(t){alert(t.data),n.close()},n.onclose=function(){},n.onerror=function(t){alert("ERROR: Check the server daemon.")}}}},this.FileUploadCallback=function(t){var e="";if(arguments.length<=0)alert("The Parameter does not exist.");else{for(var i=0;i<arguments.length-2;i++)e+=arguments[i]+"/";e=e.substr(0,e.length-1),file=arguments[arguments.length-2];var o=arguments[arguments.length-1];if(e.indexOf("./")>-1)alert("Movement of the parent directory is prohibited. \r\nPlease check your path again.");else{var a=$wai.default.downInfo.webRoots+e;n=new WebSocket($wai.default.downInfo.serviceDomain);var r="_"+Math.random().toString(36).substr(2,9);n.binaryType="arraybuffer",n.onopen=function(){var t={cmd:"login",data:r};n.send(JSON.stringify(t)),t={cmd:"fileUpload",target:a,data:"_"},n.send(JSON.stringify(t));var e=new FileReader,i=new ArrayBuffer;e.loadend=function(){},e.onload=function(t){i=t.target.result,n.send(i)},e.readAsArrayBuffer(file)},n.onmessage=function(t){o(t.data),n.close()},n.onclose=function(){},n.onerror=function(t){alert("ERROR: Check the server daemon.")}}}},this.__ExcelUpload=function(t,e,i){let o=$wai.info.path+"/lib/xlsx-populate.min.js";if("undefined"==typeof XlsxPopulate){console.log("Loading library");let n=document.createElement("script");n.setAttribute("src",o),n.setAttribute("crossorigin","anonymous"),n.setAttribute("async",""),n.onload=function(){c(t,e).then((function(t){i(t)}))},document.body.appendChild(n)}else c(t,e).then((function(t){i(t)}))},this.ExcelUpload=function(t,e){this.__ExcelUpload(t,"_",e)},this.ExcelUploadNoHead=function(t,e,i,o,n){(null==o||o<0)&&(o=0),(null==n||n<0)&&(n=0),e=e+",;"+o+";"+n,this.__ExcelUpload(t,e,i)};var a={bdLeft:{type:"thin",color:"#000000"},bdTop:{type:"thin",color:"#000000"},bdRight:{type:"thin",color:"#000000"},bdBottom:{type:"thin",color:"#000000"},bdRL:{type:"thin",color:"#000000"},bdLR:{type:"thin",color:"#000000"}},r=[];r.push({styleName:"title",bgColor:"#ffffff",font:{size:16,name:"Tahoma",color:"#000000"},fillPattern:"solidForeground"}),r.push({styleName:"header",bgColor:["#f9fbfd","#dbecfb","#d5e5f3"],font:{size:12,name:"Tahoma",color:"#000000"},fillPattern:"solidForeground"}),r.push({styleName:"cell",bgColor:"#ffffff",font:{size:11,name:"Tahoma",color:"#000000"},fillPattern:"solidForeground"});function s(t){return null==t?XlsxPopulate.fromBlankAsync():t?XlsxPopulate.fromDataAsync(t):Promise.reject("You must select a file.")}function l(t){for(var e="A".charCodeAt(0),i="Z".charCodeAt(0)-e+1,o="";t>=0;)o=String.fromCharCode(t%i+e)+o,t=Math.floor(t/i)-1;return o}function h(t){var e="";if(null!=t.font.size&&(e+='"fontSize" :'+t.font.size),null!=t.font.name&&(e+=',"fontFamily" :"'+t.font.name.replace(/\"/g,"").split(",")[0]+'"'),null!=t.font.color&&(e+=',"fontColor" :"'+t.font.color.replace(/#/g,"")+'"'),null!=t.font.style){var i=t.font.style;i.indexof("bold")>-1&&(e+=',"bold" :true'),i.indexof("italic")>-1&&(e+=',"italic" :true'),i.indexof("strikeout")>-1&&(e+=',"strikethrough" :true')}return null!=t.font.underLine&&(e+=',"underline" :"'+t.font.underLine+'"'),null!=t.font.typeOffset&&(e+=',"subscript" :"'+t.font.typeOffset+'"'),JSON.parse("{"+e+"}")}function c(t,e){return s(t).then((function(t){var i=t.sheet(0)._rows,o=new Object;if("_"==e){var n=new Array,a=new Array,r=!0;i.forEach((function(t){var e=!0,i=new Object;t._cells.forEach((function(t,o){var a="";const s=XlsxPopulate.RichText;a=t.value()instanceof s?t.value().text()||"":t.value()||"",a=String(a);var l=new Object,h=new Object;if(r){"^"==a.charAt(0)?(h.alignment="center",a=a.substring(1,a.length)):">"==a.charAt(0)?(h.alignment="right",a=a.substring(1,a.length)):"<"==a.charAt(0)&&(h.alignment="left",a=a.substring(1,a.length)),l.alignment="center",l.editable="true";var c=a.split(";");2==c.length?(h.type="CalcEdit",h.displayformat=c[1],l.text=c[0],l.field=c[0]):(h.type="text",l.text=a,l.field=a),l.editor=h,n[o-1]=l}else col=n[o-1],i[col.field]=a,""!=String(a).trim()&&(e=!1);0})),r||0==e&&a.push(i),r=!1," | \n"}));var s=new Object;return o.data=a,s.columns=n,o.options=s,JSON.stringify(o)}for(var l=0,h=0,c=(n=new Array,e.split(",")),d=0;d<c.length;d++){var u=c[d]||"",f=new Object,p=new Object;if(""!=u)if(";"!=u.charAt(0)){"^"==u.charAt(0)?(p.alignment="center",u=u.substring(1,u.length)):">"==u.charAt(0)?(p.alignment="right",u=u.substring(1,u.length)):"<"==u.charAt(0)&&(p.alignment="left",u=u.substring(1,u.length)),f.alignment="center",f.editable="true";var g=u.split(";");2==g.length?(p.type="CalcEdit",p.displayformat=g[1],f.text=g[0],f.field=g[0]):(p.type="text",f.text=u,f.field=u),f.editor=p,n.push(f)}else{var v=(u=u.substring(1,u.length)).split(";");l=Number(v[0]),h=Number(v[1])}}a=new Array;for(var b=l;b<i.length;b++){for(var m=i[b],w=!0,y=new Object,C=m._cells,O=0;O<C.length&&O<n.length;O++){var x=C[O+h];if(null!=x){u=x.value()||"";col=n[O],y[col.field]=u,""!=String(u).trim()&&(w=!1)}}0==w&&a.push(y),r=!1," | \n"}s=new Object;return o.data=a,s.columns=n,o.options=s,JSON.stringify(o)}))}function d(t,e){return function(t){return s().then((function(e){for(var i=JSON.parse(t).style,o=new Array,n=0;n<i.length;n++)o[i[n].styleName]=i[n];for(var a=JSON.parse(t).vector,r=0;r<a.length;r++){var s=l(a[r].stCell[0]),c=a[r].stCell[1]+1,d=l(a[r].edCell[0]),u=a[r].edCell[1]+1;null==a[r].width&&(a[r].width=100),e.sheet(0).cell(s+c).value(a[r].text),e.sheet(0).cell(s+c).style("border",!0),e.sheet(0).column(s).width(a[r].width/5);var f="",p=(f=""!=a[r].style&&null!=o[a[r].style]?o[a[r].style]:o.header).bgColor;(p=String(p).toUpperCase().replace(/\[/g,"").replace(/\]/g,"").replace(/\"/g,"").replace(/#/g,"")).indexOf(",")>-1?3==(p=p.split(",")).length&&e.sheet(0).cell(s+c).style("fill",{type:"gradient",angle:90,stops:[{position:0,color:p[0]},{position:.5,color:p[1]},{position:1,color:p[2]}]}):e.sheet(0).cell(s+c).style("fill",p);var g=h(f);console.log(g),e.sheet(0).cell(s+c).style(g),null!=a[r].alignment&&""!=a[r].alignment&&e.sheet(0).cell(s+c).style("horizontalAlignment",a[r].alignment),s==d&&c==u||e.sheet(0).range(s+c+":"+d+u).merged(!0)}for(var v=JSON.parse(t).relative[0],b=v.cellData,m=v.cellForm,w=0;w<b.length;w++)for(r=0;r<b[w].length;r++){var y=l(r);if(s=l(m[r][0][0]),c=m[r][0][1]+1,d=l(m[r][1][0]),u=m[r][1][1]+1,null!=m[r][5]&&"N"==m[r][5].charAt(0)){var C=m[r][5].substring(1,m[r][5].length);C=C.replace(",","#,##").replace("undefined",""),e.sheet(0).cell(y+(w+c)).value(Number(b[w][r])).style("numberFormat",C)}else e.sheet(0).cell(y+(w+c)).value(b[w][r]);e.sheet(0).cell(y+(w+c)).style("border",!0),f="",p=(f=""!=m[r][2]&&null!=o[m[r][2]]?o[m[r][2]]:o.cell).bgColor,(p=String(p).toUpperCase().replace(/\[/g,"").replace(/\]/g,"").replace(/\"/g,"").replace(/#/g,"")).indexOf(",")>-1?3==(p=p.split(",")).length&&e.sheet(0).cell(y+(w+c)).style("fill",{type:"gradient",angle:90,stops:[{position:0,color:p[0]},{position:.5,color:p[1]},{position:1,color:p[2]}]}):e.sheet(0).cell(y+(w+c)).style("fill",p),g=h(f),null!=m[r][3]&&""!=m[r][3]&&e.sheet(0).cell(y+(w+c)).style("horizontalAlignment",m[r][3]),null!=m[r][4]&&m[r][4],e.sheet(0).cell(y+(w+c)).style(g)}return e.outputAsync({type:void 0})}))}(t).then((function(t){if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(t,e);else{var i=window.URL.createObjectURL(t),o=document.createElement("a");document.body.appendChild(o),o.href=i,o.download=e,o.click(),window.URL.revokeObjectURL(i),document.body.removeChild(o)}})).catch((function(t){throw alert(t.message||t),t}))}this.ExcelDownloadRequest=function(t,e){let i=$wai.info.path+"/lib/xlsx-populate.min.js";if("undefined"==typeof XlsxPopulate){console.log("Loading library");let o=document.createElement("script");o.setAttribute("src",i),o.setAttribute("crossorigin","anonymous"),o.setAttribute("async",""),o.onload=function(){d(t,e)},document.body.appendChild(o)}else d(t,e)},this.ExportExcel=function(t){ExcelColumn=[],ExcelRow=[],ExcelForm=[];var e=JSON.parse(JSON.stringify(t.recordset.fieldInfo));for(var i in e){var o=parseInt(i);ExcelColumn.push({text:e[i].name,stCell:[o,0],edCell:[o,0],style:"header",alignment:"center".toLowerCase()}),ExcelForm.push([[o,1],[o,1],"cell","LEFT".toLowerCase()])}var n=t.recordset.getRecords();for(var i in n){var s=[];for(elem in n[i])s.push(n[i][elem]);ExcelRow.push(s)}var l="default.xlsx",h=JSON.stringify({fileName:l,sheetTitle:"Sheet1",sheetStyle:a,style:r,vector:ExcelColumn,relative:[{stCell:ExcelForm[0][0],cellForm:ExcelForm,cellData:ExcelRow}]});this.ExcelDownloadRequest(h,l)},this.ExportExcelDSO=function(t,e,i,o){ExcelColumn=[],ExcelRow=[],ExcelForm=[];e=e.split(";");var n=0;null!=o&&""!=o&&(ExcelColumn.push({text:o,stCell:[0,0],edCell:[0,0],style:"title",alignment:"center"}),n=1);for(var s=0;e.length>s;s++){var l=(e[s]+"").trim(),h="left";""!=l&&("^"==l[0]?(h="center",l=l.substr(1,l.length-1)):">"==l[0]?(h="right",l=l.substr(1,l.length-1)):"<"==l[0]&&(h="left",l=l.substr(1,l.length-1)),ExcelColumn.push({text:l,stCell:[s,n],edCell:[s,n],style:"header",alignment:"center"}),ExcelForm.push([[s,n+1],[s,n+1],"cell",h.toLowerCase()]))}var c=t.recordset.getRecords();for(var d in i=i.split(";"),c){var u=[];for(s=0;i.length>s;s++)u.push(c[d][i[s]]);ExcelRow.push(u)}var f="default.xlsx",p=JSON.stringify({fileName:f,sheetTitle:"Sheet1",sheetStyle:a,style:r,vector:ExcelColumn,relative:[{stCell:ExcelForm[0][0],cellForm:ExcelForm,cellData:ExcelRow}]});this.ExcelDownloadRequest(p,f)},this.ExportExcel_DSO=function(t,e){ExcelColumn=[],ExcelRow=[],ExcelForm=[];e=e.split(";");for(var i=0;e.length>i;i++){var o="left";""!=(c=(e[i]+"").trim())&&("^"==c[0]?(o="center",c=c.substr(1,c.length-1)):">"==c[0]?(o="right",c=c.substr(1,c.length-1)):"<"==c[0]&&(o="left",c=c.substr(1,c.length-1)),ExcelColumn.push({text:c,stCell:[i,0],edCell:[i,0],style:"header",alignment:"center"}),ExcelForm.push([[i,1],[i,1],"cell",o.toLowerCase()]))}var n=t.recordset.getRecords();for(var s in n){var l=[],h=0;for(elem in n[s]){if(h>=e.length)break;var c;""!=(c=(e[h]+"").trim())&&(l.push(n[s][elem]),h++)}ExcelRow.push(l)}var d="default.xlsx",u=JSON.stringify({fileName:d,sheetTitle:"Sheet1",sheetStyle:a,style:r,vector:ExcelColumn,relative:[{stCell:ExcelForm[0][0],cellForm:ExcelForm,cellData:ExcelRow}]});this.ExcelDownloadRequest(u,d)},this.getJsonValue=function(t,e,i,o){var n=t,a="";return $.ajax({type:"GET",url:n,dataType:"json",async:!1,success:function(t){for(var n in t)if(t[n][e]==o){a=t[n][i];break}}}),a},this.addComp=function(t,e){comp=$.parseHTML($.trim(e)),document.getElementById(t).appendChild(comp[0]),$wai.core.generateAll()},this.delComp=function(t){var e=document.getElementById("$wai$"+t+"$");$(e).remove(),delete window[t]}};function t(t,e){if(t){var i=this.data("attr-old-value");if(e.attributeName.indexOf("style")>=0){i.style||(i.style={});var o=e.attributeName.split(".");e.attributeName=o[0],e.oldValue=i.style[o[1]],e.newValue=o[1]+":"+this.prop("style")[$.camelCase(o[1])],i.style[o[1]]=e.newValue}else e.oldValue=i[e.attributeName],e.newValue=this.attr(e.attributeName),i[e.attributeName]=e.newValue;this.data("attr-old-value",i)}}$wai.rtl.anchor=new function(){var t=!1,e=["top","bottom","left","right"],i={p:{},o:{}},o=null,n=null,a=["IFRAME","IMG","TABLE","VIDEO","AUDIO","PROGRESS","CANVAS","OBJECT","EMBED"],r={tab:null,page:null,cont:null};function s(e,o){var n=void 0!==window.pageXOffset,a="CSS1Compat"===(document.compatMode||""),s=n?window.pageXOffset:a?document.documentElement.scrollLeft:document.body.scrollLeft,l=n?window.pageYOffset:a?document.documentElement.scrollTop:document.body.scrollTop;i.p=t?{width:$(window)._outerWidth(),height:$(window)._outerHeight(),top:0,left:0,right:$(window)._outerWidth(),bottom:$(window)._outerHeight(),borderTop:0,borderLeft:0,borderRight:0,borderBottom:0}:{width:$(e)._outerWidth(),height:$(e)._outerHeight(),top:l+e.getBoundingClientRect().top,left:s+e.getBoundingClientRect().left,right:s+e.getBoundingClientRect().right,bottom:l+e.getBoundingClientRect().bottom,borderTop:parseInt($(e).css("borderTop")),borderLeft:parseInt($(e).css("borderLeft")),borderRight:parseInt($(e).css("borderRight")),borderBottom:parseInt($(e).css("borderBottom"))},i.o={width:$(o)._outerWidth(),height:$(o)._outerHeight(),top:l+o.getBoundingClientRect().top,left:s+o.getBoundingClientRect().left,right:s+o.getBoundingClientRect().right,bottom:l+o.getBoundingClientRect().bottom,borderTop:parseInt($(e).css("borderTop")),borderLeft:parseInt($(e).css("borderLeft")),borderRight:parseInt($(e).css("borderRight")),borderBottom:parseInt($(e).css("borderBottom"))},r.page&&(r.page.style.display="none"),r.cont&&(r.cont.style.display="none")}function l(t){var n=o,a=i.p,r=i.o;if(n.getAttribute("yid")){$(n).prop("style").removeProperty("width"),$(n).prop("style").removeProperty("height");var s="";(p=h($(n).attr("style"))).push({name:"position",value:"absolute !important"}),p.push({name:"inset",value:"0px !important"});for(var l=0;l<p.length;l++)s+=p[l].name+":"+p[l].value+";";$(n).attr("style",s)}else for(var c=function(t){for(var i=[],o=0;o<e.length;o++)-1!=t.toLowerCase().indexOf(e[o])&&i.push(o);return i}(t),d=0;d<c.length;d++){var u=c[d]%2==0?-1:1,f=e[c[d]];c[d-u]+""&&c[d]-u===c[d-u]?(0===c[d]&&$(n).prop("style").removeProperty("height"),2===c[d]&&$(n).prop("style").removeProperty("width")):$(n).prop("style").removeProperty(e[c[d]-u]);for(var p=h($(n).attr("style")),g=!1,v=u*a[f]-u*r[f]-a["border"+f.charAt(0).toUpperCase()+f.slice(1)]+"px !important",b=0;b<p.length;b++)p[b].name==f&&(g=!0,p[b].value=v);g||p.push({name:f,value:v});for(s="",l=0;l<p.length;l++)s+=p[l].name+":"+p[l].value+";";$(n).attr("style",s)}}function h(t){var e,i=t.split(";"),o=new Array;for(var n in i)if(""!=(e=i[n].split(":"))){var a=e[0].trim();o.push({name:a,value:e[1].trim()})}return o}this.set=function(){let e;try{let t=(window.top.location.pathname+"").split("/").pop();e="waiIDE.html"==t||"waiHtmlEditor.html"==t||"waiHtmlEditorMain.html"==t}catch(t){e=!0}if(!e){for(var i,h,c=[],d=[],u=document.getElementsByTagName("*"),f=0;f<u.length;f++)for(var p=0;p<a.length;p++)u[f].getAttribute("anchor")&&a[p]==u[f].tagName&&(i=u[f],h=void 0,(h=document.createElement("anchorDiv")).style.position=$(i).css("position"),h.style.top=$(i).css("top"),h.style.bottom=$(i).css("bottom"),h.style.left=$(i).css("left"),h.style.right=$(i).css("right"),h.style.width=$(i).css("width"),h.style.height=$(i).css("height"),h.setAttribute("anchor",i.getAttribute("anchor")),d.push(h),i.removeAttribute("anchor"),$(i).prop("style").removeProperty("position"),$(i).prop("style").removeProperty("top"),$(i).prop("style").removeProperty("bottom"),$(i).prop("style").removeProperty("left"),$(i).prop("style").removeProperty("right"),$(i).css("width","100%"),$(i).css("height","100%"),c.push(i));for(var g=0;g<d.length;g++)d[g].append(c[g]),document.body.append(d[g]);!function(){for(var e=document.getElementsByTagName("*"),i=0;i<e.length;i++){r.tab=null,r.page=null,r.cont=null;var a=e[i].getAttribute("anchor")?e[i].getAttribute("anchor"):e[i].getAttribute("_anchor");a&&(o=e[i],(n=o.offsetParent)?t="BODY"==n.tagName:(t=!1,"tabPage"==o.parentElement.getAttribute("yid")?(r.tab=$(o).closest("tabcontrol")[0],r.page=o.closest("tabpage"),r.cont=$(r.page).find(".tab_content")[0],r.page.style.display="block",r.cont.style.display="block",n=r.tab):n=o.parentElement),s(n,o),l(a))}}()}}},$.fn.attrchange=function(e,i){if("object"==typeof e){var o={trackValues:!1,callback:$.noop};if("function"==typeof e?o.callback=e:$.extend(o,e),o.trackValues&&this.each((function(t,e){for(var i,o={},n=(t=0,e.attributes),a=n.length;t<a;t++)o[(i=n.item(t)).nodeName]=i.value;$(this).data("attr-old-value",o)})),MutationObserver){var n={subtree:!1,attributes:!0,attributeOldValue:o.trackValues},a=new MutationObserver((function(t){t.forEach((function(t){var e=t.target;o.trackValues&&(t.newValue=$(e).attr(t.attributeName)),void 0===$(this).data("attrchange-tdisconnect")&&o.callback.call(e,t)}))}));return this.data("attrchange-method","Mutation Observer").data("attrchange-obs",a).each((function(){a.observe(this,n)}))}return function(){var t=document.createElement("p"),e=!1;if(t.addEventListener)t.addEventListener("DOMAttrModified",(function(){e=!0}),!1);else{if(!t.attachEvent)return!1;t.attachEvent("onDOMAttrModified",(function(){e=!0}))}return t.setAttribute("id","target"),e}()?this.data("attrchange-method","DOMAttrModified").on("DOMAttrModified",(function(t){t.originalEvent&&(t=t.originalEvent),t.attributeName=t.attrName,t.oldValue=t.prevValue,void 0===$(this).data("attrchange-tdisconnect")&&o.callback.call(this,t)})):"onpropertychange"in document.body?this.data("attrchange-method","propertychange").on("propertychange",(function(e){e.attributeName=window.event.propertyName,t.call($(this),o.trackValues,e),void 0===$(this).data("attrchange-tdisconnect")&&o.callback.call(this,e)})):this}if("string"==typeof e&&$.fn.attrchange.hasOwnProperty("extensions")&&$.fn.attrchange.extensions.hasOwnProperty(e))return $.fn.attrchange.extensions[e].call(this,i)};$wai.rtl.multiLangManager=new function(){var t,e=this,i="EN",o="EN",n={};let a;try{let t=(window.top.location.pathname+"").split("/").pop();a="waiIDE.html"==t||"waiHtmlEditor.html"==t||"waiHtmlEditorMain.html"==t}catch(t){a=!0}if(a){var r;try{r=parent.parent.configData}catch(t){r=parent.parent[0].configData}if(void 0!==r&&void 0!==r.ideService)void 0!==(s=r.ideService.multiLangUse)&&"string"==typeof s&&"Y"==s.toUpperCase()&&(t=r.ideService.multiLangDicDataPath,void 0!==r.ideService.defaultLang&&(i=r.ideService.defaultLang),void 0!==r.ideService.defaultTitleLang&&(o=r.ideService.defaultTitleLang))}else{var s;void 0!==(s=$wai.default.multiLangUse)&&"string"==typeof s&&"Y"==s.toUpperCase()&&(t=$wai.default.multiLangDicDataPath,void 0!==$wai.default.defaultLang&&(i=$wai.default.defaultLang),void 0!==$wai.default.defaultTitleLang&&(o=$wai.default.defaultTitleLang))}if(void 0!==t){let e="",i=new XMLHttpRequest;i.open("GET",t+"/waiMultiLangData.json",!1),i.send(),200==i.status&&(e=i.responseText,n=JSON.parse(e))}this.setElemLanguage=function(t,e){var a=n[e],r=void 0!==a?a[i]:void 0;if(void 0!==r)switch(t.tagName){case"LABEL":case"SPAN":case"DIV":case"BUTTON":case"TD":if(t.innerHTML=r,i!==o){var s=void 0!==a?a[o]:void 0;t.title=void 0!==s?s:""}break;case"INPUT":t.placeholder=r}},this.setLanguage=function(t,e,i){var o,a,r,s,l,h=$(i).find("label[lang],span[lang],div[lang],button[lang]");for(o=0;o<h.length;o++)a=$(h[o]).attr("lang"),void 0!==(s=void 0!==(r=n[a])?r[t]:void 0)&&(h[o].innerHTML=s,t!==e&&(l=void 0!==r?r[e]:void 0,h[o].title=void 0!==l?l:""));var c=$(i).find("td[lang]");for(o=0;o<c.length;o++)a=$(c[o]).attr("lang"),void 0!==(s=void 0!==(r=n[a])?r[t]:void 0)&&(c[o].innerHTML=s,t!==e&&(l=void 0!==r?r[e]:void 0,c[o].title=void 0!==l?l:""));var d=$(i).find("input[lang]");for(o=0;o<d.length;o++)a=$(d[o]).attr("lang"),void 0!==(s=void 0!==(r=n[a])?r[t]:void 0)&&(d[o].placeholder=s);var u=$wai.rtl.metaCodeManager.getWaiCodeDataDicData(),f=u.length;if(f>0){var p=$(i).find("codecombo[codeData]");for(o=0;o<p.length;o++)if(void 0!==p[o].compObj.codeData&&""!=p[o].compObj.codeData)for(var g=0;g<f;g++)if(p[o].compObj.codeData==u[g].code_id){var v=[],b=p[o].compObj.value;for(var m in p[o].compObj.data)for(var w in u[g].data)if(p[o].compObj.data[m].CODE==u[g].data[w].code){s=void 0!==(r=n[u[g].data[w].code_name])?r[t]:void 0,v.push({CODE:u[g].data[w].code,CODE_NM:s});break}p[o].compObj.data=v,p[o].compObj.value=b;break}}},this.setDefaultLang=function(t){i=t},this.getDefaultLang=function(){return i},this.setDefaultTitleLang=function(t){o=t},this.getDefaultTitleLang=function(){return o},this.setWaiMultiLangDicData=function(t){n=t},this.getWaiMultiLangDicData=function(){return n},this.setCurrentPageLanguage=function(t,n,a){var r=i,s=o;void 0!==n&&""!=n&&(r=n),void 0!==a&&""!=a&&(s=a),e.setLanguage(r,s,t.body)},this.set=function(){e.setCurrentPageLanguage(document)}};$wai.rtl.metaCodeManager=new function(){var t,e=this,i=[];let o;try{let t=(window.top.location.pathname+"").split("/").pop();o="waiIDE.html"==t||"waiHtmlEditor.html"==t||"waiHtmlEditorMain.html"==t}catch(t){o=!0}if(o){var n=void 0;try{n=parent.parent.configData}catch(t){n=parent.parent[0].configData}if(void 0!==n&&void 0!==n.ideService)void 0!==(a=n.ideService.codeDataUse)&&"string"==typeof a&&"Y"==a.toUpperCase()&&(t=n.ideService.codeDataDicDataPath)}else{var a;void 0!==(a=$wai.default.codeDataUse)&&"string"==typeof a&&"Y"==a.toUpperCase()&&(t=$wai.default.codeDataDicDataPath)}if(void 0!==t){let e="",o=new XMLHttpRequest;o.open("GET",t+"/waiMetaCodeData.json",!1),o.send(),200==o.status&&(e=o.responseText,i=function(t){for(var e=[],i=0;i<t.length;i++){var o=n(t[i]);o?o.data.push({code:t[i].CODE,code_name:t[i].CODE_NAME,code_desc:t[i].CODE_DESC}):e.push({code_id:t[i].CODE_ID,code_id_name:t[i].CODE_ID_NAME,code_id_desc:t[i].CODE_ID_DESC,data:[{code:t[i].CODE,code_name:t[i].CODE_NAME,code_desc:t[i].CODE_DESC}]})}function n(t){for(var i=null,o=0;o<e.length;o++)if(t.CODE_ID==e[o].code_id){i=e[o];break}return i}return e}(JSON.parse(e)))}this.setElemCodeData=function(t,e){for(var o=null,n=0;n<i.length;n++)if(i[n].code_id==e){o=i[n];break}if(o&&"CODECOMBO"===t.tagName.toUpperCase()){for(var a=[],r=o.data,s=0;s<r.length;s++){var l=new Object;l[t.idField]=r[s].code,l[t.textField]=r[s].code_name,a.push(l)}a.length>0&&(t.data=a)}},this.setCodeData=function(t){var e,o,n,a=$(t).find("codecombo");for(e=0;e<a.length;e++)if(o=a[e].compObj.codeData){for(var r=0;r<i.length;r++)if(i[r].code_id==o){n=i[r];break}if(n){for(var s=[],l=n.data,h=0;h<l.length;h++){var c=new Object;c[a[e].compObj.idField]=l[h].code,c[a[e].compObj.textField]=l[h].code_name,s.push(c)}if(s.length>0){var d=a[e].compObj.value;a[e].compObj.data=s,a[e].compObj.value=d}}}},this.setWaiCodeDataDicData=function(t){i=t},this.getWaiCodeDataDicData=function(){return i},this.setCurrentPageCodeData=function(t,i,o){e.setCodeData(t.body)},this.set=function(){e.setCurrentPageCodeData(document)}}}();